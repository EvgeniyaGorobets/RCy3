<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cancer networks and data • RCy3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cancer networks and data">
<meta property="og:description" content="RCy3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RCy3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.15.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cancer-networks-and-data.html">Cancer networks and data</a>
    </li>
    <li>
      <a href="../articles/Custom-Graphics.html">Custom Graphics and Labels</a>
    </li>
    <li>
      <a href="../articles/Cytoscape-and-NDEx.html">Cytoscape and NDEx</a>
    </li>
    <li>
      <a href="../articles/Cytoscape-and-graphNEL.html">Cytoscape and graphNEL</a>
    </li>
    <li>
      <a href="../articles/Cytoscape-and-iGraph.html">Cytoscape and igraph</a>
    </li>
    <li>
      <a href="../articles/Filtering-Networks.html">Filtering Networks</a>
    </li>
    <li>
      <a href="../articles/Group-nodes.html">Group nodes</a>
    </li>
    <li>
      <a href="../articles/Identifier-mapping.html">Identifier mapping</a>
    </li>
    <li>
      <a href="../articles/Importing-data.html">Importing data</a>
    </li>
    <li>
      <a href="../articles/Network-functions-and-visualization.html">Network functions and visualization</a>
    </li>
    <li>
      <a href="../articles/Overview-of-RCy3.html">Overview of RCy3</a>
    </li>
    <li>
      <a href="../articles/Phylogenetic-trees.html">Phylogenetic-trees</a>
    </li>
    <li>
      <a href="../articles/Upgrading-existing-scripts.html">Upgrading existing scripts</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cytoscape/RCy3/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Cancer-networks-and-data_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cancer networks and data</h1>
                        <h4 class="author">by Alexander Pico</h4>
            
            <h4 class="date">2021-11-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cytoscape/RCy3/blob/master/vignettes/Cancer-networks-and-data.Rmd"><code>vignettes/Cancer-networks-and-data.Rmd</code></a></small>
      <div class="hidden name"><code>Cancer-networks-and-data.Rmd</code></div>

    </div>

    
    
<p>This vignette will demonstrate network retrieval from the STRING database, basic analysis, TCGA data loading and visualization in Cytoscape from R using the RCy3 package.</p>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"RCy3"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
    <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"RCy3"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cytoscape/RCy3">RCy3</a></span><span class="op">)</span>

<span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"RColorBrewer"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"RColorBrewer"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></code></pre></div>
</div>
<div id="required-software" class="section level1">
<h1 class="hasAnchor">
<a href="#required-software" class="anchor"></a>Required Software</h1>
<p>The whole point of RCy3 is to connect with Cytoscape. You will need to install and launch Cytoscape:</p>
<ul>
<li>Download the latest Cytoscape from <a href="http://www.cytoscape.org/download.php" class="uri">http://www.cytoscape.org/download.php</a>
</li>
<li>Complete installation wizard</li>
<li>Launch Cytoscape</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/cytoscapePing.html">cytoscapePing</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>For this vignette, you’ll also need the STRING app to access the STRING database from within Cytoscape: * Install the STRING app from <a href="https://apps.cytoscape.org/apps/stringapp" class="uri">https://apps.cytoscape.org/apps/stringapp</a></p>
<p>#<code>{r} #available in Cytoscape 3.7.0 and above installApp('STRINGapp')   #</code></p>
</div>
<div id="getting-disease-networks" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-disease-networks" class="anchor"></a>Getting Disease Networks</h1>
<p>Use Cytoscape to query the STRING database for networks of genes associated with breast cancer and ovarian cancer.</p>
<p><strong>If the STRING app is not installed, no error is reported, but your network will be empty</strong></p>
<div id="query-string-database-by-disease-to-generate-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#query-string-database-by-disease-to-generate-networks" class="anchor"></a>Query STRING database by disease to generate networks</h2>
<div id="breast-cancer" class="section level3">
<h3 class="hasAnchor">
<a href="#breast-cancer" class="anchor"></a>Breast cancer</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">string.cmd</span> <span class="op">=</span> <span class="st">'string disease query disease="breast cancer" cutoff=0.9 species="Homo sapiens" limit=150'</span>
<span class="fu"><a href="../reference/commandsRun.html">commandsRun</a></span><span class="op">(</span><span class="va">string.cmd</span><span class="op">)</span></code></pre></div>
<p>Here we are using Cytoscape’s command line syntax, which can be used for any core or app automation function, and then making a GET request. Use <em>commandsHelp</em> to interrogate the functions and parameters available in your active Cytoscape session, including the apps you’ve installed!</p>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/brc.png" style="height:100.0%"></p>
</div>
<div id="ovarian-cancer" class="section level3">
<h3 class="hasAnchor">
<a href="#ovarian-cancer" class="anchor"></a>Ovarian cancer</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">string.cmd</span> <span class="op">=</span> <span class="st">'string disease query disease="ovarian cancer" cutoff=0.9 species="Homo sapiens" limit=150'</span>
<span class="fu"><a href="../reference/commandsRun.html">commandsRun</a></span><span class="op">(</span><span class="va">string.cmd</span><span class="op">)</span></code></pre></div>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/ovc.png" style="height:100.0%"></p>
</div>
</div>
</div>
<div id="interacting-with-cytoscape" class="section level1">
<h1 class="hasAnchor">
<a href="#interacting-with-cytoscape" class="anchor"></a>Interacting with Cytoscape</h1>
<p>Now that we’ve got a couple networks into Cytoscape, let’s see what we can do with them from R…</p>
<div id="get-list-of-networks" class="section level2">
<h2 class="hasAnchor">
<a href="#get-list-of-networks" class="anchor"></a>Get list of networks</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getNetworkList.html">getNetworkList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="layout-network" class="section level2">
<h2 class="hasAnchor">
<a href="#layout-network" class="anchor"></a>Layout network</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span>layout.name<span class="op">=</span><span class="st">'circular'</span><span class="op">)</span> </code></pre></div>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/ovc2.png" style="height:100.0%"></p>
<div id="list-of-layout-algorithms-available" class="section level3">
<h3 class="hasAnchor">
<a href="#list-of-layout-algorithms-available" class="anchor"></a>List of layout algorithms available</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getLayoutNames.html">getLayoutNames</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="layout-with-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#layout-with-parameters" class="anchor"></a>Layout with parameters!</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getLayoutPropertyNames.html">getLayoutPropertyNames</a></span><span class="op">(</span>layout.name<span class="op">=</span><span class="st">'force-directed'</span><span class="op">)</span>
<span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span><span class="st">'force-directed defaultSpringCoefficient=0.0000008 defaultSpringLength=70'</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="get-table-data-from-network" class="section level2">
<h2 class="hasAnchor">
<a href="#get-table-data-from-network" class="anchor"></a>Get table data from network</h2>
<p>Now, let’s look at the tablular data associated with our STRING networks…</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/getTableColumnNames.html">getTableColumnNames</a></span><span class="op">(</span><span class="st">'node'</span><span class="op">)</span></code></pre></div>
<p>One of the great things about the STRING database is all the node and edge attriubtes they provide. Let’s pull some of it into R to play with…</p>
<div id="retrieve-disease-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieve-disease-scores" class="anchor"></a>Retrieve disease scores</h3>
<p>We can retrieve any set of columns from Cytoscape and store them as an R data frame keyed by SUID. In this case, let’s retrieve the disease score column from the node table. Those will be our two parameters:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">disease.score.table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getTableColumns.html">getTableColumns</a></span><span class="op">(</span><span class="st">'node'</span>,<span class="st">'stringdb::disease score'</span><span class="op">)</span>
<span class="va">disease.score.table</span></code></pre></div>
</div>
<div id="plot-distribution-and-pick-threshold" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-distribution-and-pick-threshold" class="anchor"></a>Plot distribution and pick threshold</h3>
<p>Now you can use R like you normally would explore the data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">)</span><span class="op">)</span>,<span class="va">disease.score.table</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, ylab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html">colnames</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="generate-subnetworks" class="section level2">
<h2 class="hasAnchor">
<a href="#generate-subnetworks" class="anchor"></a>Generate subnetworks</h2>
<p>In order to reflect your exploration back onto the network, let’s generate subnetworks…</p>
<p>…from top quartile of ‘disease score’</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top.quart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="fl">0.75</span><span class="op">)</span>
<span class="va">top.nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html">which</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&gt;</span><span class="va">top.quart</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="../reference/createSubnetwork.html">createSubnetwork</a></span><span class="op">(</span><span class="va">top.nodes</span>,subnetwork.name <span class="op">=</span><span class="st">'top disease quartile'</span><span class="op">)</span>
<span class="co">#returns a Cytoscape network SUID</span></code></pre></div>
<p>…of connected nodes only</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/createSubnetwork.html">createSubnetwork</a></span><span class="op">(</span>edges<span class="op">=</span><span class="st">'all'</span>,subnetwork.name<span class="op">=</span><span class="st">'top disease quartile connected'</span><span class="op">)</span>  <span class="co">#handy way to exclude unconnected nodes!</span></code></pre></div>
<p>…from first neighbors of top 3 genes, using the network connectivity together with the data to direct discovery.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setCurrentNetwork.html">setCurrentNetwork</a></span><span class="op">(</span>network<span class="op">=</span><span class="st">"STRING network - ovarian cancer"</span><span class="op">)</span>
<span class="va">top.nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">disease.score.table</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="../reference/selectNodes.html">selectNodes</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">top.nodes</span><span class="op">)</span>
<span class="fu"><a href="../reference/selectFirstNeighbors.html">selectFirstNeighbors</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/createSubnetwork.html">createSubnetwork</a></span><span class="op">(</span><span class="st">'selected'</span>, subnetwork.name<span class="op">=</span><span class="st">'top disease neighbors'</span><span class="op">)</span> <span class="co"># selected nodes, all connecting edges (default)</span></code></pre></div>
<p>…from diffusion algorithm starting with top 3 genes, using the network connectivity in a more subtle way than just first-degree neighbors.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setCurrentNetwork.html">setCurrentNetwork</a></span><span class="op">(</span>network<span class="op">=</span><span class="st">"STRING network - ovarian cancer"</span><span class="op">)</span>
<span class="fu"><a href="../reference/selectNodes.html">selectNodes</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">top.nodes</span><span class="op">)</span>
<span class="fu"><a href="../reference/commandsPOST.html">commandsPOST</a></span><span class="op">(</span><span class="st">'diffusion diffuse'</span><span class="op">)</span> <span class="co"># diffusion!</span>
<span class="fu"><a href="../reference/createSubnetwork.html">createSubnetwork</a></span><span class="op">(</span><span class="st">'selected'</span>,subnetwork.name <span class="op">=</span> <span class="st">'top disease diffusion'</span><span class="op">)</span>
<span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span><span class="st">'force-directed'</span><span class="op">)</span></code></pre></div>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/ovc4.png" style="height:100.0%"></p>
<p><em>Pro-tip</em>: don’t forget to <strong>setCurrentNetwork()</strong> to the correct parent network before getting table column data and making selections.</p>
</div>
</div>
<div id="visualizing-data-on-networks" class="section level1">
<h1 class="hasAnchor">
<a href="#visualizing-data-on-networks" class="anchor"></a>Visualizing data on networks</h1>
<div id="load-datasets" class="section level2">
<h2 class="hasAnchor">
<a href="#load-datasets" class="anchor"></a>Load datasets</h2>
<p>Downloaded TCGA data, preprocessed as R objects. Also available via each TCGA publication, e.g.:</p>
<ul>
<li>Breast: <a href="https://tcga-data.nci.nih.gov/docs/publications/brca_2012/" class="uri">https://tcga-data.nci.nih.gov/docs/publications/brca_2012/</a>
</li>
<li>Ovarian: <a href="https://tcga-data.nci.nih.gov/docs/publications/ov_2011/" class="uri">https://tcga-data.nci.nih.gov/docs/publications/ov_2011/</a>
</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"tutorial-ovc-expr-mean-dataset.robj"</span>, package<span class="op">=</span><span class="st">"RCy3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"tutorial-ovc-mut-dataset.robj"</span>, package<span class="op">=</span><span class="st">"RCy3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"tutorial-brc-expr-mean-dataset.robj"</span>, package<span class="op">=</span><span class="st">"RCy3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"tutorial-brc-mut-dataset.robj"</span>, package<span class="op">=</span><span class="st">"RCy3"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="breast-cancer-datset" class="section level2">
<h2 class="hasAnchor">
<a href="#breast-cancer-datset" class="anchor"></a>Breast Cancer Datset</h2>
<p>These datasets are similar to the data frames you normally encounter in R. For diversity, one using row.names to store corresponding gene names and the other uses the first column. Both are easy to import into Cytoscape.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">brc.expr</span><span class="op">)</span>  <span class="co"># gene names in row.names of data.frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">brc.mut</span><span class="op">)</span>  <span class="co"># gene names in column named 'Hugo_Symbol'</span></code></pre></div>
<p>Let’s return to the Breast Cancer network…</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setCurrentNetwork.html">setCurrentNetwork</a></span><span class="op">(</span>network<span class="op">=</span><span class="st">"STRING network - breast cancer"</span><span class="op">)</span>
<span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span><span class="st">'force-directed'</span><span class="op">)</span> <span class="co">#uses same settings as previously set</span></code></pre></div>
<p>…and use the helper function from RCy3 called <em>loadTableData</em></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">loadTableData</span>
<span class="fu"><a href="../reference/loadTableData.html">loadTableData</a></span><span class="op">(</span><span class="va">brc.expr</span>,table.key.column <span class="op">=</span> <span class="st">"display name"</span><span class="op">)</span>  <span class="co">#default data.frame key is row.names</span>
<span class="fu"><a href="../reference/loadTableData.html">loadTableData</a></span><span class="op">(</span><span class="va">brc.mut</span>,<span class="st">'Hugo_Symbol'</span>,table.key.column <span class="op">=</span> <span class="st">"display name"</span><span class="op">)</span>  <span class="co">#specify column name if not default</span></code></pre></div>
<div id="visual-styles" class="section level3">
<h3 class="hasAnchor">
<a href="#visual-styles" class="anchor"></a>Visual styles</h3>
<p>Let’s create a new style to visualize our imported data …starting with the basics, we will specify a few defaults and obvious mappings in a custom style all our own.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">style.name</span> <span class="op">=</span> <span class="st">"dataStyle"</span>
<span class="fu"><a href="../reference/createVisualStyle.html">createVisualStyle</a></span><span class="op">(</span><span class="va">style.name</span><span class="op">)</span>
<span class="fu"><a href="../reference/setVisualStyle.html">setVisualStyle</a></span><span class="op">(</span><span class="va">style.name</span><span class="op">)</span>

<span class="fu"><a href="../reference/setNodeShapeDefault.html">setNodeShapeDefault</a></span><span class="op">(</span><span class="st">"ellipse"</span>, <span class="va">style.name</span><span class="op">)</span> <span class="co">#remember to specify your style.name!</span>
<span class="fu"><a href="../reference/setNodeSizeDefault.html">setNodeSizeDefault</a></span><span class="op">(</span><span class="fl">60</span>, <span class="va">style.name</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeColorDefault.html">setNodeColorDefault</a></span><span class="op">(</span><span class="st">"#AAAAAA"</span>, <span class="va">style.name</span><span class="op">)</span>
<span class="fu"><a href="../reference/setEdgeLineWidthDefault.html">setEdgeLineWidthDefault</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">style.name</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeLabelMapping.html">setNodeLabelMapping</a></span><span class="op">(</span><span class="st">'display name'</span>, <span class="va">style.name</span><span class="op">)</span></code></pre></div>
<div id="visualize-expression-data" class="section level4">
<h4 class="hasAnchor">
<a href="#visualize-expression-data" class="anchor"></a>Visualize expression data</h4>
<p>Now let’s update the style with a mapping for mean expression. The first step is to grab the column data from Cytoscape and pull out the min and max to define our data mapping range of values.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brc.expr.network</span> <span class="op">=</span> <span class="fu"><a href="../reference/getTableColumns.html">getTableColumns</a></span><span class="op">(</span><span class="st">'node'</span>,<span class="st">'expr.mean'</span><span class="op">)</span>  
<span class="va">min.brc.expr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">brc.expr.network</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">max.brc.expr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">brc.expr.network</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">data.values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">min.brc.expr</span>,<span class="fl">0</span>,<span class="va">max.brc.expr</span><span class="op">)</span></code></pre></div>
<p>Next, we use the RColorBrewer package to help us pick good colors to pair with our data values.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data.values</span><span class="op">)</span>, colorblindFriendly<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"div"</span><span class="op">)</span> <span class="co"># div,qual,seq,all</span>
<span class="va">node.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data.values</span><span class="op">)</span>, <span class="st">"RdBu"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Finally, we use the handy <em>mapVisualProperty</em> function to construct the data object that CyREST needs to specify style mappings and then we’ll send them off to Cytoscape with <em>updateStyleMappings</em>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setNodeColorMapping.html">setNodeColorMapping</a></span><span class="op">(</span><span class="st">'expr.mean'</span>, <span class="va">data.values</span>, <span class="va">node.colors</span>, style.name<span class="op">=</span><span class="va">style.name</span><span class="op">)</span></code></pre></div>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/brc2.png" style="height:100.0%"></p>
<p><strong>Pro-tip: depending on your data, it may be better to balance your color range over negative and positive values bounded by the largest min or max data value, so that color intensity scales similarly in both directions.</strong></p>
</div>
</div>
<div id="visualize-mutation-data" class="section level3">
<h3 class="hasAnchor">
<a href="#visualize-mutation-data" class="anchor"></a>Visualize mutation data</h3>
<p>OK, now let’s update with a mapping for mutation. Here are all the same steps, but this time mapping mutation counts to <em>both</em> node border width and color.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brc.mut.network</span> <span class="op">=</span> <span class="fu"><a href="../reference/getTableColumns.html">getTableColumns</a></span><span class="op">(</span><span class="st">'node'</span>,<span class="st">'mut_count'</span><span class="op">)</span>
<span class="va">min.brc.mut</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">brc.mut.network</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">max.brc.mut</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">brc.mut.network</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">data.values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">min.brc.mut</span>,<span class="fl">20</span>,<span class="va">max.brc.mut</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">display.brewer.all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">data.values</span><span class="op">)</span>, colorblindFriendly<span class="op">=</span><span class="cn">TRUE</span>, type<span class="op">=</span><span class="st">"seq"</span><span class="op">)</span> 
<span class="va">border.colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>, <span class="st">"Reds"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeBorderColorMapping.html">setNodeBorderColorMapping</a></span><span class="op">(</span><span class="st">'mut_count'</span>,<span class="va">data.values</span>,<span class="va">border.colors</span>,style.name<span class="op">=</span><span class="va">style.name</span><span class="op">)</span>
<span class="va">border.width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeBorderWidthMapping.html">setNodeBorderWidthMapping</a></span><span class="op">(</span><span class="st">'mut_count'</span>,<span class="va">data.values</span>,<span class="va">border.width</span>,style.name<span class="op">=</span><span class="va">style.name</span><span class="op">)</span></code></pre></div>
<p>This is a useful pair of visual properties to map to a single data column. See why?</p>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/brc3.png" style="height:100.0%"></p>
</div>
<div id="subnetwork-based-on-diffusion-from-heavily-mutated-nodes" class="section level3">
<h3 class="hasAnchor">
<a href="#subnetwork-based-on-diffusion-from-heavily-mutated-nodes" class="anchor"></a>Subnetwork based on diffusion from heavily mutated nodes</h3>
<p>Now, let’s pull in what we learned about subnetwork selection and apply it here…</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top.mut</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">brc.mut</span><span class="op">$</span><span class="va">Hugo_Symbol</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html">order</a></span><span class="op">(</span><span class="va">brc.mut</span><span class="op">$</span><span class="va">mut_count</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="va">top.mut</span>
<span class="fu"><a href="../reference/selectNodes.html">selectNodes</a></span><span class="op">(</span>nodes<span class="op">=</span><span class="va">top.mut</span>,<span class="st">'display name'</span><span class="op">)</span>
<span class="fu"><a href="../reference/commandsPOST.html">commandsPOST</a></span><span class="op">(</span><span class="st">'diffusion diffuse'</span><span class="op">)</span> 
<span class="fu"><a href="../reference/createSubnetwork.html">createSubnetwork</a></span><span class="op">(</span><span class="st">'selected'</span>,subnetwork.name <span class="op">=</span> <span class="st">'top mutated diffusion'</span><span class="op">)</span>
<span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span><span class="st">'force-directed'</span><span class="op">)</span></code></pre></div>
<p>The top mutated genes are based on TCGA data and the diffusion algorithm is operating based on the network connectivity from STRING data, leading to a focused subnetwork view of critical Breast Cancer genes with mean patient expression data mapped to fill color. Now <em>that’s</em> data integration!</p>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/brc4.png" style="height:100.0%"></p>
<p><strong>Pro-tip: You can generate a legend for this in Cytoscape Style tab &gt; Options &gt; Create style… This is no yet available as a command. Coming soon!</strong></p>
</div>
</div>
<div id="ovarian-cancer-datset" class="section level2">
<h2 class="hasAnchor">
<a href="#ovarian-cancer-datset" class="anchor"></a>Ovarian Cancer Datset</h2>
<p>But what about the other network and datasets? Do we have to repeat <em>all</em> of those steps again? Actually, no!</p>
<p>First, let’s switch back over to the Ovarian Cancer network and load our data.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setCurrentNetwork.html">setCurrentNetwork</a></span><span class="op">(</span>network<span class="op">=</span><span class="st">"STRING network - ovarian cancer"</span><span class="op">)</span>
<span class="fu"><a href="../reference/clearSelection.html">clearSelection</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ovc.expr</span><span class="op">)</span>  <span class="co"># gene names in row.names of data.frame</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">ovc.mut</span><span class="op">)</span>  <span class="co"># gene names in column named 'Hugo_Symbol'</span>

<span class="fu"><a href="../reference/loadTableData.html">loadTableData</a></span><span class="op">(</span><span class="va">ovc.expr</span>, table.key.column <span class="op">=</span> <span class="st">'display name'</span><span class="op">)</span>
<span class="fu"><a href="../reference/loadTableData.html">loadTableData</a></span><span class="op">(</span><span class="va">ovc.mut</span>,<span class="st">'Hugo_Symbol'</span>, table.key.column <span class="op">=</span> <span class="st">'display name'</span><span class="op">)</span></code></pre></div>
<p><strong>Because we used the same column names in our original data frames, now we can simply apply the <em>same</em> visual style created above!</strong></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setVisualStyle.html">setVisualStyle</a></span><span class="op">(</span>style.name<span class="op">=</span><span class="va">style.name</span><span class="op">)</span></code></pre></div>
<p><img src="https://cytoscape.github.io/cytoscape-automation/for-scripters/R/notebooks/data/img/ovc3.png" style="height:100.0%"></p>
<p>Reusing the same style for both breast and ovarian cancers, we can compare the relative expression and mutation counts across the two datasets. For example, notice in the case of ovarian cancer: <strong>decreased</strong> range of mean expression and <strong>fewer</strong> mega-mutated genes.</p>
</div>
</div>
<div id="saving-sharing-and-publishing" class="section level1">
<h1 class="hasAnchor">
<a href="#saving-sharing-and-publishing" class="anchor"></a>Saving, sharing and publishing</h1>
<div id="saving-a-cytoscape-session-file" class="section level2">
<h2 class="hasAnchor">
<a href="#saving-a-cytoscape-session-file" class="anchor"></a>Saving a Cytoscape session file</h2>
<p>Session files save <em>everything</em>. As with most project software, we recommend saving often!</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/saveSession.html">saveSession</a></span><span class="op">(</span><span class="st">'tutorial_session'</span><span class="op">)</span> <span class="co">#.cys</span></code></pre></div>
<p><strong>Note:</strong> If you don’t specify a complete path, the files will be saved relative to your current working directory in R.</p>
</div>
<div id="saving-high-resolution-image-files" class="section level2">
<h2 class="hasAnchor">
<a href="#saving-high-resolution-image-files" class="anchor"></a>Saving high resolution image files</h2>
<p>You can export extremely high resolution images, including vector graphic formats.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/exportImage.html">exportImage</a></span><span class="op">(</span>filename<span class="op">=</span><span class="st">'tutorial_image2'</span>, type <span class="op">=</span> <span class="st">'PDF'</span><span class="op">)</span> <span class="co">#.pdf</span>
<span class="op">?</span><span class="va">exportImage</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alex Pico, Tanja Muetze, Paul Shannon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
