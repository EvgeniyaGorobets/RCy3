<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Phylogenetic-trees • RCy3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Phylogenetic-trees">
<meta property="og:description" content="RCy3">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RCy3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.15.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Cancer-networks-and-data.html">Cancer networks and data</a>
    </li>
    <li>
      <a href="../articles/Custom-Graphics.html">Custom Graphics and Labels</a>
    </li>
    <li>
      <a href="../articles/Cytoscape-and-NDEx.html">Cytoscape and NDEx</a>
    </li>
    <li>
      <a href="../articles/Cytoscape-and-graphNEL.html">Cytoscape and graphNEL</a>
    </li>
    <li>
      <a href="../articles/Cytoscape-and-iGraph.html">Cytoscape and igraph</a>
    </li>
    <li>
      <a href="../articles/Filtering-Networks.html">Filtering Networks</a>
    </li>
    <li>
      <a href="../articles/Group-nodes.html">Group nodes</a>
    </li>
    <li>
      <a href="../articles/Identifier-mapping.html">Identifier mapping</a>
    </li>
    <li>
      <a href="../articles/Importing-data.html">Importing data</a>
    </li>
    <li>
      <a href="../articles/Network-functions-and-visualization.html">Network functions and visualization</a>
    </li>
    <li>
      <a href="../articles/Overview-of-RCy3.html">Overview of RCy3</a>
    </li>
    <li>
      <a href="../articles/Phylogenetic-trees.html">Phylogenetic-trees</a>
    </li>
    <li>
      <a href="../articles/Upgrading-existing-scripts.html">Upgrading existing scripts</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/cytoscape/RCy3/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Phylogenetic-trees_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Phylogenetic-trees</h1>
                        <h4 class="author">Alexander Pico, Gildas Lepennetier</h4>
            
            <h4 class="date">2021-11-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cytoscape/RCy3/blob/master/vignettes/Phylogenetic-trees.Rmd"><code>vignettes/Phylogenetic-trees.Rmd</code></a></small>
      <div class="hidden name"><code>Phylogenetic-trees.Rmd</code></div>

    </div>

    
    
<p>This vignette will show you how to work the popular Newick format for phylogenetic trees in Cytoscape by conversion to igraph and import via RCy3. The initial conversion step was provided by <a href="https://github.com/GildasLepennetier/newick_to_graphml" class="uri">https://github.com/GildasLepennetier/newick_to_graphml</a>.</p>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"RCy3"</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span>
    <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span><span class="op">(</span><span class="st">"RCy3"</span><span class="op">)</span>
<span class="op">}</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cytoscape/RCy3">RCy3</a></span><span class="op">)</span></code></pre></div>
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h2>
<p>We will also need a few additional packages for the file conversion steps:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'ape'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'phytools'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">'igraph'</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools">phytools</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></code></pre></div>
<p>In addition to these R packages, you will need <strong>Cytoscape 3.7</strong> or greater, which can be downloaded from <a href="https://cytoscape.org/download.html" class="uri">https://cytoscape.org/download.html</a>. Simply follow the installation instructions on screen.</p>
</div>
</div>
<div id="trees-to-networks" class="section level1">
<h1 class="hasAnchor">
<a href="#trees-to-networks" class="anchor"></a>Trees to Networks</h1>
<p>Phylogenetic trees are simply a special type of network. And Cytoscape can work with <em>any</em> type of network! Trees are often represented in the <a href="https://en.wikipedia.org/wiki/Newick_format">Newick format</a>, like so</p>
<pre><code>((raccoon:19.19959,bear:6.80041):0.84600,((sea_lion:11.99700, seal:12.00300):7.52973,((monkey:100.85930,cat:47.14069):20.59201, weasel:18.87953):2.09460):3.87382,dog:25.46154);

(Bovine:0.69395,(Gibbon:0.36079,(Orang:0.33636,(Gorilla:0.17147,(Chimp:0.19268, Human:0.11927):0.08386):0.06124):0.15057):0.54939,Mouse:1.21460):0.10;

(Bovine:0.69395,(Hylobates:0.36079,(Pongo:0.33636,(G._Gorilla:0.17147, (P._paniscus:0.19268,H._sapiens:0.11927):0.08386):0.06124):0.15057):0.54939, Rodent:1.21460); </code></pre>
<p>The first step to loading Newick files into Cytoscape is to convert them to more generic network format using igraph, which Cytoscape already knows how to read via the RCy3 package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">phytools</span><span class="fu">::</span><span class="fu">read.newick</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>,<span class="st">"phylotree.newick"</span>, package<span class="op">=</span><span class="st">"RCy3"</span><span class="op">)</span><span class="op">)</span>
<span class="va">ig</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu">as.igraph.phylo</span><span class="op">(</span><span class="va">tree</span>, <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># boolean for whether tree is rooted or not</span>
<span class="va">ig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/set_edge_attr.html">set_edge_attr</a></span><span class="op">(</span><span class="va">ig</span>,<span class="st">'distance'</span>, value<span class="op">=</span><span class="va">tree</span><span class="op">$</span><span class="va">edge.length</span><span class="op">)</span> <span class="co"># set distances as edge attributes</span></code></pre></div>
</div>
<div id="network-to-cytoscape" class="section level1">
<h1 class="hasAnchor">
<a href="#network-to-cytoscape" class="anchor"></a>Network to Cytoscape</h1>
<p>From here it’s a simple matter of loading the igraph network into Cytoscape. RCy3 has a function for that:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/createNetworkFromIgraph.html">createNetworkFromIgraph</a></span><span class="op">(</span><span class="va">ig</span>, title<span class="op">=</span><span class="st">"phylotree"</span>, collection <span class="op">=</span> <span class="st">"phylotree"</span><span class="op">)</span></code></pre></div>
<p>Now it just needs a layout a bit of style…</p>
<p>A force-directed layout can work well for trees, if it is tuned properly. You might need to adjust some of the parameters to get a good layout for other Newick files, but the following works well for the demo file in this vignette.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">'force-directed'</span>,
                    <span class="st">'defaultEdgeWeight=3'</span>,
                    <span class="st">'defaultSpringCoefficient=5E-5'</span>,
                    <span class="st">'defaultSpringLength=80'</span>,
                    sep <span class="op">=</span> <span class="st">' '</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><em>Pro-tip: In the GUI of Cytoscape you also have access to yFiles Layouts (after accepting the license). Their hierarchical layout is perfect for trees! Unfortunately, it is not accessible via scripting however due to license restrictions.</em></p>
<p>Also, notice how the junction nodes, which are nameless in the Newick format, are given generic names by igraph (like “Node1”)and display too promonently in Cytoscape. Let’s create a filter to select these nodes and alter their style.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/createColumnFilter.html">createColumnFilter</a></span><span class="op">(</span><span class="st">'junctions'</span>, <span class="st">'id'</span>, <span class="st">"^Node\\\\d+$"</span>, <span class="st">"REGEX"</span><span class="op">)</span>
<span class="va">junctions</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/getSelectedNodes.html">getSelectedNodes</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeWidthBypass.html">setNodeWidthBypass</a></span><span class="op">(</span><span class="va">junctions</span>,<span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeHeightBypass.html">setNodeHeightBypass</a></span><span class="op">(</span><span class="va">junctions</span>,<span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="../reference/setNodeLabelBypass.html">setNodeLabelBypass</a></span><span class="op">(</span><span class="va">junctions</span>, <span class="st">""</span><span class="op">)</span></code></pre></div>
</div>
<div id="edge-length-as-distance" class="section level1">
<h1 class="hasAnchor">
<a href="#edge-length-as-distance" class="anchor"></a>Edge Length as Distance</h1>
<p>And, as a final touch, let’s label our edges with distance values:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setEdgeLabelMapping.html">setEdgeLabelMapping</a></span><span class="op">(</span><span class="st">'distance'</span><span class="op">)</span></code></pre></div>
<p>We can also explore layouts that consider edge lengths, such as:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/layoutNetwork.html">layoutNetwork</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html">paste</a></span><span class="op">(</span><span class="st">'force-directed'</span>,
                    <span class="st">'edgeAttribute="distance"'</span>,
                    <span class="st">'type="1 - normalized value"'</span>,
                    <span class="st">'defaultSpringCoefficient=5E-4'</span>,
                    <span class="st">'defaultSpringLength=50'</span>,
                    sep <span class="op">=</span> <span class="st">' '</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Notice how “monkey” with a much larger distance of just over 100 is now positioned much further from the other more closely related nodes.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alex Pico, Tanja Muetze, Paul Shannon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
